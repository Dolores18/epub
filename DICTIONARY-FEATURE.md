# 📚 EPUB阅读器词典功能

## 功能概述

为EPUB阅读器集成了强大的日语词典查询功能，支持实时文本选择查询和在线词典API。

## ✨ 主要特性

### 🔍 智能查询
- **实时文本选择**：选中文本自动查询
- **在线词典API**：集成真实的日语词典数据
- **多种输入方式**：支持汉字、假名、片假名
- **模糊匹配**：智能匹配相似单词

### 🎨 用户界面
- **侧边面板**：美观的词典查询面板
- **加载状态**：实时显示查询进度
- **错误处理**：友好的错误提示
- **响应式设计**：适配各种屏幕尺寸

### ⌨️ 操作方式
- **鼠标操作**：点击按钮、选择文本
- **键盘快捷键**：D键切换词典功能
- **触摸支持**：移动设备友好

## 🚀 使用方法

### 1. 基本操作

#### 打开词典面板
- 点击底部菜单的 🔍 按钮
- 点击右上角的 📚 按钮
- 使用快捷键 `D`

#### 查询单词
1. **选择文本查询**：
   - 在EPUB文本中选中日语单词
   - 词典面板自动显示查询结果

2. **手动输入查询**：
   - 点击词典面板的搜索框
   - 输入日语单词
   - 按回车键或点击 🔍 按钮

### 2. 高级功能

#### 复制文本
- 点击 📋 按钮复制选中的文本到剪贴板

#### 清空搜索
- 点击 🗑️ 按钮清空搜索框和结果

#### 开关词典
- 点击 🔧 按钮启用/禁用词典功能
- 禁用时不会响应文本选择

## 🔧 技术实现

### API集成
```javascript
// 使用真实的日语词典API
const response = await fetch(`https://dict.3049589.xyz/api/japanese/definition?word=${word}`);
```

### 数据格式
```javascript
{
    reading: "ちんぎん",           // 读音
    meaning: "労働の報酬として...", // 释义
    type: "名词",                 // 词性
    writings: "賃金、賃銀",        // 书写形式
    examples: [],                 // 例句
    source: "旺文社国語辞典"       // 词典来源
}
```

### 异步处理
- 使用 `async/await` 处理API请求
- 显示加载状态和错误处理
- 支持并发查询

## 📱 快捷键

| 快捷键 | 功能 |
|--------|------|
| `D` | 切换词典功能 |
| `ESC` | 关闭所有面板 |
| `Enter` | 在搜索框中执行查询 |

## 🎯 使用场景

### 日语学习
- 阅读日语EPUB时查询生词
- 学习汉字读音和释义
- 查看例句和用法

### 文本理解
- 快速理解复杂词汇
- 查看多音字的不同读音
- 了解词汇的语法功能

### 内容研究
- 分析文本中的关键词
- 研究词汇的使用频率
- 对比不同词汇的用法

## 🔍 测试方法

### 1. 启动测试服务器
```bash
python3 start-server.py
```

### 2. 访问测试页面
- 打开 `http://localhost:8080/test-dictionary.html`
- 测试各种查询功能

### 3. 测试用例
- **賃金**：测试汉字查询
- **こんにちは**：测试假名查询
- **森**：测试简单汉字查询

## 🛠️ 自定义配置

### 修改词典数据
```javascript
// 在 dictionary.js 中修改本地词典数据
const dictionaryData = {
    '自定义单词': {
        reading: '读音',
        meaning: '释义',
        type: '词性',
        examples: ['例句']
    }
};
```

### 更换API
```javascript
// 修改API端点
const response = await fetch(`你的API地址?word=${word}`);
```

### 调整样式
```css
/* 修改词典面板样式 */
.dictionary-panel {
    width: 400px;  /* 调整宽度 */
    height: 600px; /* 调整高度 */
}
```

## 🐛 故障排除

### 常见问题

1. **词典面板不显示**
   - 检查JavaScript是否正确加载
   - 查看浏览器控制台错误信息

2. **查询无结果**
   - 检查网络连接
   - 确认API服务是否正常
   - 尝试不同的单词

3. **文本选择不响应**
   - 确认词典功能已启用
   - 检查文本是否可选中
   - 刷新页面重试

### 调试方法
```javascript
// 在浏览器控制台中测试
Dictionary.show();           // 显示词典
Dictionary.search('賃金');   // 测试查询
Dictionary.toggle();         // 切换功能
```

## 📈 性能优化

### 缓存机制
- 本地词典数据优先查询
- 避免重复API请求
- 智能匹配减少网络请求

### 用户体验
- 延迟查询避免频繁触发
- 加载状态提示
- 错误信息友好显示

## 🔮 未来扩展

### 计划功能
- [ ] 历史查询记录
- [ ] 收藏夹功能
- [ ] 多词典切换
- [ ] 发音功能
- [ ] 离线词典支持

### 技术改进
- [ ] 更智能的文本识别
- [ ] 上下文相关查询
- [ ] 机器学习优化
- [ ] 多语言支持

---

## 📞 技术支持

如果遇到问题或有建议，请：
1. 查看浏览器控制台错误信息
2. 检查网络连接状态
3. 尝试刷新页面
4. 联系开发者获取帮助

---

*最后更新：2025年1月* 